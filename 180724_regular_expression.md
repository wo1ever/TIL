# 180724

## 오전수업 애란쌤

### 정규표현식 #1

#### 배운 내용들을 어떻게 분류할까?

- 파이썬 문법

- 라이브러리:

  - 라이브러리는 계속 새로 개발되므로 끊임없이 공부해야 함.
  - 자주 쓰이는 라이브러리와 자주 쓰이는 함수들이 있음.
  - 하다보면 요령이 생김!

- 파이썬 안에서 실행되는 "미니 언어"들:

  - CSS selector
  - 정규표현식 : 어떤 것처럼 생긴 것을 찾아주거나, 바꾸어주기 가능.
  - 한 번 배워두면 오만군데에서 여러군데에 다 써먹을 수 있음.

- 알고리즘과 자료구조:

  - 원하는 일을 효율적으로 시키기.

    데이터를 shuffling 하는 방법, 더 빨리 섞을 수 있고, 더 메모리를 적게 쓸 수 있는 방법?

  - 대부분의 중요한 알고리즘은 99% 이미 개발 되어 있음.

    구글, 게임 개발 팀, 길을 조금 돌아가게 하기 등 새롭게 만들어야 하는 경우도 있긴 함.

- 확률/통계(지현쌤 시간):

  - 데이터 분석에 핵심과도 같음.... 중요한 것일수록 현실과 동떨어져 보일 수 있음.ㅠㅠ 하지만 결국 모든 것의 기초가 됨.
  - 현상을 정량적으로 이해하기
  - 알려진 정보를 근거로 알려지지 않은 정보를 추측하기
  - 의사결정에 따른 실행결과를 정량적으로 평가하기

- 확률/통계와 프로그래밍의 관계:

  - 확/통의 일부 혹은 전부를 자동화

네트워킹, 운영체제론 ... 등

#### 실무 이야기

A/B test (Randomized Controlled Experiment, RCT):

- 애란쌤의 실무 이야기:

  **쇼핑몰 상품 배치**

  기획전, 신상품, 여름할인 등의 이벤트가 있을 때, 어떤 자리에 상품을 어떻게 놓일 지 갱장한 고민을 해야 함.

  각각의 기획전 화면에 대한 AB test를 진행.

  사람이 상품을 배치한 경우, 알고리즘 1, 2번이 상품을 배치한 경우 비교를 하여 가장 좋은 배치를 찾음.

  대부분의 경우 구매 전환율이 5% 미만.

  95% 신뢰구간을 보아, 다른 대안들과 안겹치면 좋은거. 겹치게 되면 조금 더 정밀한 검증이 필요함.

  어지간하면 24시간 일만 하는 기계가 사람보다 잘함.

  **게임 맵**

  게임 기획차가 원치 않는 상황 : 1등과 꼴찌가 격차가 많이 안나기.

  random track을 골랐을 때, 어떤때는 랜덤 트랙을 주고, 어떤 때는 잘팀/못팀의 격차가 적게 잘 설계된 트랙을 줌.

  잘하는 팀과 못하는 팀의 격차가 조금 줄어듬.

  **Facebook** 의 AB test

  몰랐겠지만 앱 하단의 아이콘과 배지, 알람 문구도 수시로 변경됨.

  사용자가 조금 더 오래 페북에 머물도록 몇십가지를 테스트함.

- 기존 디자인과 새 디자인을 랜덤하게 사용자들에게 보여주고 차이를 봄.

- null / alternative hypothesis를 설정하고 확인.

- **Type 1 error** : 영향이 없는데 있는 것으로 판명하는 오류 (false positive)

- Type 2 error : 영향이 있는데 없는 것으로 판명하는 오류 (false negative)

  상황에 따라 오류의 심각성이 달라짐.

  (eg) 보통의 상업적인 경우, type1error에 초점을 맞춤. 화재경보기의 경우 type2error를 훨씬 주의해야 함.

- p-value

  보통 0.05로 설정 : AB test를 동일하게 100번정도 반복했을 때 null hypothesis가 맞다면 금액 차이가 평균적으로 0이어야 함. 하지만 여러번 반복하다보면 완전 0이지는 않음. 보통 정규분포를 따르게 됨.

  - H0이 맞지만 엄청난 우연인 경우
  - H0이 틀렸을 경우

- 통계적으로 유의하지만 효과크기가 작다면?

  실험을 왜곡하는 p hacking : 기간을 늘려 통계적으로 유의미하게 바꾸어벌임.

AB test는 대표성 있는 집단으로부터 샘플을 가져와야 함. 여성 쇼핑몰의 광고를 남성 카페에 하면 안됨!

random sampling 되어 온 사람들에게 실험군/대조군으로 나누어 random assignment를 주어야 함.

#### 과제 피드백

- 중간점검 보폭 줄이기, 자주 확인하기

- 더 나은 방법 찾기

- 다른 분들의 도움 적극적으로 활용하기

- 매직넘버 제거

- 실수 기록하기 > 망해도 빠르게 잘 망하고 배우자....

- 함수를 적극적으로 활용하기

  함수에 대한 장단점 : 함수를 만들게 되면 indirection이 생겨 왔다갔다 하며 봐야 한다는 단점. 안만들게 되면 불필요한 반복이 여러 번 생길 수 있음.

#### 정규표현식 소개(Regular Expression)

정규 표현식에서 `\d\d` 숫자 두 개를 뜻함. 하지만 파이선에서는 escaping으로 읽힘.

```python
greeting = "Hello, he said \"You're a data scientist.\""
```

```python
r"\d"  # 정규 표현식에서의 raw string 표현
```

#### 정규표현식 배우고 연습하기

순차적으로 매치되는 글자들 **앞부터 뒤로 한글자씩!** 순서대로 찾아 후보가 됨.

한글자에 매치시키기

- 메타캐릭터

  앞부터 순차적으로 실행됨.

   `^` : 문장의 시작에 해당 글자가 나오는 것들을 찾음.

   ` $` : 문장의 끝에 해당 글자가 나오는 것들을 찾음.

  `\b` : 각종 단어의 경계

  (eg) `\b\S+\b` : 특수문자 사이에 있는 하나 이상의 빈칸이 아닌 것들

- 이스케이프

  `\` : 정규표현식 문법이 아니라, 문자 그 자체를 찾고 싶을 때 ($500, ^^ 등)

  ```python
  # 아래의 두 표현이 같은 의미
  re.sub(r'\$500', '50,000,000원', "$500만 주세요")
  re.sub('\\$500', '50,000,000원', "$500만 주세요")
  # $를 표시해주기 위해 \를 썼는데 파이썬에서도 \가 특별한 문자이기 때문에 \를 또 써줘야 함.
  ```

- 캐릭터 클래스 `[...]`

  `"[초중고]3"` : 초3 or 중3 or 고3

  `"[초중고][123]"` : 초1, 중1, 고1, 초2, 중2, 고2, 초3, 중3, 고3

  `"se[ae]r[ae]te"` 

- 캐릭터 클래스 메타캐릭터 [1-3]

  `"[a-zA-F]"` : 소문자 abcd...yzABCDEF 를 찾음.

  무조건 대과라호 안에 써야 함.

- 메타캐릭터(추가)

  `.` 아무 문자나 한 글자

  `\d` 아무 숫자 한 글자 (== `[0-9]`)

  `\D` 숫자가 아닌 어떤 한 글자

  `\s` 공백 한 글자

  `\S` 공백이 아닌 아무 글자 하나

  `\w` word(영문, 숫자, 일부 특문) 중 하나

  

## 오후수업 (이어서)

### Question

##### Q) 컴퓨터는 한글을 어떻게 처리할까?

- 1 byte = 8 bits (8칸에 0과 1을 할당하여 256가지 경우를 나타낼 수 있음)
- ASCII code : 총 128(2의 7승)개의 문자 (A-Z, a-z, 0-9, $, !, ...)
  - 7칸의 bit조합으로 128개의 문자를 할당해 놓음.
  - 맨 앞 칸은 항상 0으로 채워짐.
- 한글/중국어/일본어 R to L ??????
- 한국에서는 한글을 표현할 수 있는 문자체계를 만들었음. KSC5601
  - 2byte로 한글자를 표기
  - ASCII code와 차이를 두기 위해 맨 앞 칸에 1을 할당하는 방식으로 사용
  - 근데 국제표준으로 사용할 수 없었음.
- unicode로 표준화 기구가 생겨 모든 나라의 언어를 표현할 수 있게 됨.
  - unicode 체계에서는 초/중/종성의 연산을 수행할 수 있는 특별한 숫자를 부여함.
  - 종성을 분리해 내어 자동으로 '은는이가' 자동으로 할당할 수 있는 프로그램을 만들 수도 있게 됨.
- utf-8
  - unicode를 부호화(인코딩)하는 하나의 방식
  - 테이블을 실제로 메모리에 올리거나 전송할 때 목적에 맞게 부호화하여 전송하게 됨.
  - 영미권 문자는 기존의 ASCII code를 거의 그대로 전송시킴.
  - CJK 문자는 특별한 형식으로 전환하여 전송시켜줌.

#### 정규표현식을 더 잘 이해해보기

- 시각화해보기 **https://regexper.com/** 

  ![1532410132701](C:\Users\wolever\AppData\Local\Temp\1532410132701.png)

- "정규표현식"?

  - Regular language의 문법을 기술하는 표현식

  - (형식)언어란?

    - 유한한 알파벳과 일정한 규칙의 형식을 가지고 있는 모든 문자열의 모음이 정규표현식에 의해 정의되는 정규문법

    - 정규 언어들 : 이메일, 전화번호 등

    - 파이썬 문장은 정규언어로 표현할 수가 없음(?)

      무한히 중첩될 수 있는 언어들(for 문 안의 함수 안의 함수 가능)은 표현될 수 없음.

  - Finite state automaton: 가장 단순한 수준의 문법을 기술할 수 있는 인공언어

    정규표현식을 사용하여, 일종의 기계를 만들어 낸 셈

  - GOFAI(Good Old-Fashioned AI)
    어떤 의미에서는 딥러닝과 대립되는 전통에 속하는 기술 중 하나.

    Simbolic AI : 어떤 simbol을 가지고 어떤 규칙에 의해 잘 정의된 연산을 수행하면, 그 기계가 지능적인 행동을 하도록 만드는 것. 인공지능 연구의 초창기에 많았음.

  - ANN(Artificial Neural Network) > DANN(Deep ANN)

    GOFAI와 대립 관계

    word2vec 은 이쪽에 ANN쪽에 가까움. 통계적인 접근

- 규칙이 뻔한 것들은 GOFAI에! 잘 모르겠어? DNNㄱㄱ



#### 배우고 연습하기(이어서)

재귀적 결합 가능

- 얼터레이션 (alteration) `(...|...|...)`

  각 ... 에 여러 글자를 넣을 수 있음.

  `[ ... ]` 안에는 몇 글자를 넣더라도 각 문자 하나씩을 선택함. 

- 양화사 (quantifier)

  `?` 바로 앞 문자가 있거나(1개), 없거나(0개)  (eg) `-?` '-'이 있거나 없거나

  `*` 바로 앞 문자가 0개 이상 존재

  `+` 바로 앞 문자가 1개 이상 존재

  ```
  [ㅋㄲ]*
  > ㅋㅋㅋㄲㄲㄲㄲㅋㅋㅋㅋㅋㅋ
  ```

  `{a}` 바로 앞 문자가 정확히 a개 존재

  `{a,b}` 바로 앞 문자가 a-b개 존재

- Capture groups `( ... )`

  - 기준으로 찾은 후 괄호 안의 부분만 잡아서 뽑아내기

    여는 괄호`(`를 기준으로 그룹 번호가 매겨짐.

  - 캡쳐그룹이 하나 생길 때 마다 dataframe에 column이 하나씩 생김.

  (eg) ((존경|친애)하옵?는) : group#1 (존경하는,친애하는) group#2 (존경, 친애)

  `\b[1-9]\d{0,2}(,\d{3})*원을.+손해`

  should match / should not match를 써놓고 하나씩 실행해보기

  ```
  Should match:
  나는 5,000원을 손해봤다.
  나는 5원을 손해봤다.
  나는 50원을 손해봤다.
  나는 500원을 손해봤다.
  나는 400,000,000원을 손해 봤다.
  나는 30,000원, 45,000원을 손해 봤다.
  나는 30,000 원을 손해 봤다.
  
  Should not match:
  나는 삼각형, 사각형, 원을 손해봤다.
  나는 삼각형, 비타5,원을 손해봤다.
  나는 5,00원을 손해봤다.
  
  Nice to have:
  5백만원을 손해봤다.
  ```

- Non-greedy quantifier

  - 모호성을 걸러주기

    `.+\.` 시작해서 아무 글자나 나오다가 .을 아무글자나 해석하던가? 마지막 점으로 인식하는가의 문제. 따라서 최대한 많이 문자를 인식하는 쪽으로 선택됨.

    '안녕하세요. 반갑습니다.' 를 만나게 되면 '안녕하세요.' 의 '점'을 만나게 되면, 아무글자 VS 마지막 점 으로 인식하는데 아무글자로 치고 넘어간 다음 마지막 점을 만날 때까지 매치시킴.

    `.+?\.` ?를 넣어주면 quantifier를 최소한만 매치시키는 방식으로 바꾸어 줌(최단경로로만 매칭)

- 예제 email 선택하기

  `\w[\w\+\.]*@\w+(\.\w+)*`

  