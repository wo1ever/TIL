# 180810

## 오전수업 아파트분양가, 공원 데이터 (배로쌤)

### 소스트리와 공공데이터 분석

#### 아파트분양가격(201806).csv

- `to_numeric` 숫자 형식으로 바꿔주기 (`astype`으로 쓸 수도 있음.)

  가격 등에 콤마가 들어가는 경우에는 따로 처리를 해 주어야 함.

- 연도와 월은 스트링형태의 데이터

- `df_2013_2018 = pd.concat([df_2013_2015_prepare, df_2015_2018_prepare])`: merge는 가로로 붙여주는거, concat은 세로로 데이터프레임을 붙여 줌.



---

## 오후수업 통계수업 (지현쌤)

### 분산분석

#### 분산분석표

p-value만 확인하면 됩니다.

#### F분포

- 두 개의 자유도에 따라서 값이 달라짐.
- 두 평균의 가설검정 과정에서는 Z분포를 사용했음.
- 집단 내 편차 중 집단 간 편차를 확인해봄.

### 분산분석-실습(choco, choco2)

#### 분산분석(ANOVA, Analysis of Variance)



### 상관분석

(eg) 생산량에 영향을 미치는 요인들의 상관계수를 그려보았더니, 0.45가 나왔다.

이러한 상관계수들을 눈대중으로 나누지 않고, 가설검정을 통해 상관관계의 유무를 판단하고자 한다.

#### 상관분석(Correlation Analysis)

두 개의 연속형 변수에 대해서, 상관계수를 이용하여 선형 관계를 분석

#### 상관계수(Correlation Coefficient)

- 양의 상관관계

  x값이 증가할수록 y값이 증가하는 양상

- 음의 상관관계

  x값이 증가할수록 y값이 줄어드는 양상

- 값의 크기는 선형관계의 강도를 의미 (r = 1, -1), r = 0: 선형관계가 없음.

상관계수는 반드시 산점도와 함께 계산해야 함

#### 상관분석의 가설, 검정

귀무가설 : 상관계수 = 0, 두 자료의 상관관계가 없다.

대립가설 : 상관계수 != 0, 두 자료의 상관관계가 있다.

- 두 개의 연속형 변수의 모집단에서 상관계수가 0인지를 검정

#### 가설 검정결과 해석

- 검정결과 p-value가 유의수준보다 작을 경우 귀무가설을 기각



### 회귀분석

#### 백화점 매출액 예측

- (eg) 백화점을 운영하는 데잇이는 다음 주 매출액을 예측하려고 한다.
- 회귀분석: 예측하고 싶은 자료를 그 자료에 영향을 주는 자료들의 선형 식을 도출하는 것

#### 회귀(regression)분석의 기원

- 회귀(regression): 옛날 상태로 돌아감.
- 영국의 유전학자인 갈톤경이 부모의 키와 아이들의 키 사이의 연관관계를 연구했던 것에서 유래.

#### 회귀분석(Linear Regression)

- 두 변수(독립/종속) 사이 관계의 통계적 유의미성을 검증하고, 또 그 관계의 정도를 분석하는 것.
- (eg) 담배 소비(y)가 나이, 교육, 수입, 담배가격 등 다양한 사회경제적 및 인구사회적 변수들(x1, x2, ...)과 관련되어 있는지를 조사하고자 한다.

#### 단순 선형 회귀분석(Simple Linear Reg. Anal.)

설명 변수가 한 개인 선형회귀모형을 의미하며, 설명변수 X와 반응변수 Y에 대하여 하나의 식으로 나타냄.

#### 다중 선형 회귀분석(Multiple Linear Reg. Anal.)

설명변수가 두 개 이상인 선형회귀모형

#### 회귀분석 용어 정리

Y: 종속(반응, 결과)변수

X: 독릭(설명, 원인)변수

회귀 계수, 오차항

#### 선형(Linear) 회귀모형

절편과 기울기가 있음.

- 절편: 선형 회귀식의 절편
- 기울기: 선형 회귀식의 각도

선형회귀분석은 가지고 있는 데이터를 직선형태로 나타내는 선을 찾는다.

#### 회귀식 구하기

다양한 회귀선을 구할 수 있지만, 그 중에 가지고 있는 데이터들을 가장 잘 나타내줄 수 있는 대표 선을 찾는다.

- 잔차(residual)이 존재함.
- 오차(error)들을 가장 최소로 하는 회귀식을 찾아 구함.

#### 최소 제곱 추정법(Ordinary Least Square : OLS)

실제 값과 예측값의 차이에 대한 제곱을 모든 관측치에 대해 계산하여 합했을 때 가장 작게하는 회귀식을 선택한다.
$$
y=
$$

#### 연속형 변수의 해석

독립변수 X가 한 단위 증가할 때 Y의 평균 변화량

#### 지시변수(Dummy Variable)

- 지시변수: 범주형 변수를 처리하기 위해, class의 개수 -1 개의 1,0으로 이루어진 변수로 전환시킨 변수

#### 범주형 변수의 해석


$$
y=370.36+3.24x_e-4.96x_t
$$

- 이디야 커피가 스타벅스 커피보다 평균 3.14 kcal 더 높다.
- 투썸 커피가 스타벅스 커피보다 평균 4.96kcal 더 낮다.

#### 모형의 적합도, 설명력 : 결정계수 (R-square)

- 결정계수(R^2): X가 Y를 얼마나 설명하는지에 관한 정보를 제공(회귀식이 얼마나 정확한지)
- 반응변수 (Y)의 전체 변동(SST)중 예측변수(X)가 차지하는 변동(SST)의 비율
- r = corr(y, yhat)
- R^2 = 1: 회귀직선으로 Y를 완전히 설명할 수 있음.(회귀식의 정확도가 매우 높음)
- R^2 = 0: 추정된 회귀직선은 X와 Y의 관계를 전혀 설명하지 못함.(회귀식의 정확도가 매우 낮음을 의미)

#### 결정계수 (R-square)

회귀식에 대하여 판단할 수 있음.

#### 모형의 적합도 :결정계수 (R-square)

R^2 = 0.8 : 추정된 호귀식으로 아들의 키를 80% 설명할 수 있다.

아들의 키(y)는 아버지의 키(x)에 의해 80% 설명됨.

### 회귀분석 - 실습(Boston)

#### 회귀분석 - 1, 2, 3

#### 회귀분석의 가정

회귀분석은 다음의 가정을 바탕으로 함.

- x와 y는 선형관계(선형성)
- 오차는 정규분포를 따른다 = y는 정규분포를 따른다. (정규성)
  - 각 x값에 대하여 모집단에서의 y값은 정규분포를 따름
  - y값 분포의 분산은 모든 x값에서 같다(sigma 제곱)
- 독립변수(x) 상호간에는 상관관계가 없어야 한다.
  - 독립변수들간에 상관관계가 나타나는 경우 '다중공선선'이라고 함.

#### 회귀분석의 가정 - 선형성

산점도 등의 그림을 통해 확인

하지만 4차원 이상의 그림을 그릴 수 없기 때문에 y와 x1, x2 , x3 각각을 그려 보기도 함.

#### 회귀분석의 가정 - 정규성

히스토그램을 그려본 후 정규분포 모양을 띄는 지 확인

Q-Q plot을 그려본 후 직선 위에 위치하는 지 확인(직선 위에 저들이 모여있다면 데이터는 정규분포를 따른다고 할 수 있음)

Quantile-quantile plot: 두 자료의 분위 수를 확인한 후 두 자료의 분포가 일치하는 지 확인.

#### 회귀분석의 가정 - 다중공선성

- 다중공선성: 독립변수(x) 들간의 상관계수가 높은 상황.

- 다중공선성으로 인해 발생하는 문제점:

  회귀계수(coefficient)의 분산(variance)이 커짐.

  (유의한 회귀계수가 유의하지 않다고 판단될 수 있음)

- 해결방법:

  1. 상관관계가 높은 독립변수 중 하나 혹은 일부를 제거한다.

  2. 변수를 변환함

  3. PCA(Principal C_ Analysis)방법을 이용해 공선성을 제거해준다.

     단점: 방식이 아예 달라져, 변수를 보고 해석을 못하게 됨.

#### 회귀분석의 가정 실습

- 선형성

  각각의 scatter matrix를 그려보고 확인해 봄.

- 정규성

  히스토그램을 그려봄.

- 다중공선성

#### 변수선택의 필요성

- 독립변수의 수가 지나치게 많다면?
  - 실제와는 다른 결과가 얻어질 수 있음. 특히 독립변수들 간의 상관성이 높아진다면 결과가 잘못 될 가능성이 높아짐.
  - 차원의 저주(overfitting발생 가능)
  - 유의하지 않은 변수들도 계속 사용해야 함.

#### 변수선택 방법

1. 전진선택법: x1선택 > x2선택 > stop > **x1 + x2**
2. 후진제거법: x1 + x2 + x3 + x4 > x4제거 > x1제거 > stop > **x1 + x2 + x3**
3. 단계적 선택법: x1선택 > x1제거 > x2선택 > x3선택 > stop > **x2 + x3**

본인이 설정한 기준(R-square이나 p-value 등)에 맞게 선택하면 됨.